---
title: "Untitled"
output: html_document
date: "2023-09-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(tidyverse)
library(lubridate)
```

```{r} 
community_types <- read.csv(here("data", "raw_data", "community_types.csv"))

par <- read.csv(here("data", "clean_data", "par_clean.csv"))

cover <- read.csv(here("data", "clean_data", "percent_cover_clean.csv"))

temperature <- read.csv(here("data", "clean_data", "temperature.csv")) %>% 
  dplyr::select(!X) %>% 
  mutate(month = month(date))

vpd <- read.csv(here("data", "clean_data", "vpd.csv")) %>% 
  dplyr::select(!X) %>% 
  mutate(month = month(date))
```

```{r}
max_temperature <- temperature %>% 
  group_by(plot, date) %>% 
  reframe(temperature = max(temperature)) %>% 
  mutate(month = month(date)) %>% 
  group_by(plot, month) %>% 
  reframe(temperature = mean(temperature)) %>% 
  left_join(community_types, by = "plot")

TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 3)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 4)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 5)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 6)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 7)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 8)))
TukeyHSD(aov(temperature~as.factor(community), data = max_temperature %>% filter(month == 9)))

max_vpd <- vpd %>% 
  group_by(plot, date) %>% 
  reframe(vpd = max(vpd)) %>% 
  mutate(month = month(date)) %>% 
  group_by(plot, month) %>% 
  reframe(vpd = mean(vpd)) %>%
  left_join(community_types, by = "plot")

TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 3)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 4)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 5)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 6)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 7)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 8)))
TukeyHSD(aov(vpd~as.factor(community), data = max_vpd %>% filter(month == 9)))
```
```{r}
temperature_vpd <- max_temperature %>% 
  inner_join(max_vpd, by = c("plot", "month", "community"))

summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 3)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 4)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 5)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 6)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 7)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 8)))
summary(manova(cbind(temperature, vpd) ~ as.factor(community), data = temperature_vpd %>% filter(month == 9)))
```


